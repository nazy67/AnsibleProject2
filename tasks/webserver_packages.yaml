- name: Install Application Webserver
  when: ansible_facts['hostname'] == "webserver"
  yum:
    name: "{{ app_packages }}"
    state: latest

- name: Install remi repositories
  when: ansible_facts['hostname'] == "webserver"
  yum:
    name: http://rpms.remirepo.net/enterprise/remi-release-7.rpm
    state: present

- name: Install yum utils
  when: ansible_facts['hostname'] == "webserver"
  yum:
    name: yum-utils
    state: latest  

- name: Enable remi-php72 repository
  when: ansible_facts['hostname'] == "webserver"
  yum_repository:
    metalink: https://mirrors.fedoraproject.org/metalink?repo=testing-epel7&arch=$basearch
    description: Extra Packages for Enterprise Linux 7 - Testing - $basearch
    name: remi-php72
    enabled: yes

- name: Update Repos on Webserver
  when: ansible_facts['hostname'] == "webserver"      
  yum: 
    name: "*"
    state: latest

- name: Install php7.2
  when: ansible_facts['hostname'] == "webserver"
  yum:
    name: "{{ php_package }}"
    state: present
    enablerepo: "remi-*,base,epel"

# This example we just download wordpress but since we we want to unzip it too we used the next:
#- name: Download WordPress
#  when: ansible_facts['hostname'] == "webserver"
#  get_url: 
#    url: https://wordpress.org/latest.tar.gz
#    dest: /tmp/wordpress.tar.gz
#    #owner: httpd
#    #group: httpd

- name: Download and unarchive WordPress
  when: ansible_facts['hostname'] == "webserver"
  unarchive:
    src: https://wordpress.org/latest.tar.gz
    dest: /tmp/
    remote_src: yes

- name: Copy WordPress files to /var/www/html with owner and permissions
  when: ansible_facts['hostname'] == "webserver" 
  copy:
    src: /tmp/wordpress/    # we use '/' because we want to copy just content of wordpress folder
    dest: /var/www/html/
    owner: apache
    group: apache
    remote_src: yes                     